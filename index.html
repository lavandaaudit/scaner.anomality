<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ANOMALY_SCANNER · PLANETARY_LOG · PRO 2026</title>
    <style>
        :root {
            --bg: #010405;
            --accent: #00ffcc;
            --danger: #ff0055;
            --warning: #ffcc00;
            --cosmic: #bc00ff;
            --glass: rgba(5, 12, 15, 0.95);
            --border: rgba(0, 255, 204, 0.3);
            --font-mono: 'Courier New', monospace;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            background: #000;
            color: #d0fff5;
            font-family: var(--font-mono);
            overflow: hidden;
            min-height: 100vh;
            user-select: none;
        }

        #bg-canvas {
            position: fixed;
            inset: 0;
            z-index: 1;
            opacity: 0.5;
        }

        #ui-wrapper {
            position: relative;
            z-index: 100;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }

        #ui-dock {
            display: flex;
            gap: 25px;
            max-width: 1400px;
            width: 100%;
            pointer-events: none;
            transform: scale(0.9);
            transform-origin: center;
        }

        /* LEFT BLOCK: SCANNER */
        #scanner-panel {
            width: 380px;
            background: var(--glass);
            border: 1px solid var(--border);
            border-radius: 4px;
            backdrop-filter: blur(30px);
            padding: 20px;
            box-shadow: 0 0 50px rgba(0, 255, 204, 0.1);
            pointer-events: auto;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        #scanner-panel::before {
            content: "SCAN_MODULE_v4.5";
            position: absolute;
            top: -10px;
            left: 20px;
            background: #000;
            color: var(--accent);
            font-size: 9px;
            padding: 0 8px;
            border: 1px solid var(--border);
        }

        .header {
            font-size: 12px;
            letter-spacing: 3px;
            color: var(--accent);
            text-transform: uppercase;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            font-weight: 900;
        }

        #anomaly-status {
            min-height: 50px;
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .status-tag {
            background: rgba(0, 255, 204, 0.05);
            border: 1px solid var(--accent);
            color: var(--accent);
            font-size: 10px;
            padding: 8px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: bold;
        }

        .status-tag.danger {
            background: rgba(255, 0, 85, 0.1);
            border-color: var(--danger);
            color: var(--danger);
            animation: pulse-danger 1.5s infinite;
        }

        .status-tag.warning {
            background: rgba(255, 204, 0, 0.1);
            border-color: var(--warning);
            color: var(--warning);
        }

        @keyframes pulse-danger {

            0%,
            100% {
                opacity: 1;
                filter: brightness(1);
            }

            50% {
                opacity: 0.6;
                filter: brightness(1.5);
            }
        }

        .viz-box {
            width: 100%;
            height: 180px;
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(0, 255, 204, 0.1);
            margin-bottom: 15px;
            position: relative;
            overflow: hidden;
        }

        .data-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 15px;
        }

        .data-item {
            border: 1px solid rgba(0, 255, 204, 0.15);
            padding: 8px;
            background: rgba(0, 30, 25, 0.4);
        }

        .data-item label {
            display: block;
            font-size: 7px;
            color: var(--accent);
            opacity: 0.6;
            margin-bottom: 4px;
            text-transform: uppercase;
        }

        .data-item span {
            font-size: 12px;
            font-weight: bold;
            color: #fff;
        }

        .loc-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 4px;
            max-height: 180px;
            overflow-y: auto;
            padding-right: 5px;
            border-top: 1px solid var(--border);
            padding-top: 10px;
            margin-top: 10px;
        }

        .loc-grid::-webkit-scrollbar {
            width: 2px;
        }

        .loc-grid::-webkit-scrollbar-thumb {
            background: var(--border);
        }

        .btn {
            background: rgba(0, 255, 204, 0.05);
            border: 1px solid var(--border);
            color: var(--accent);
            font-size: 8px;
            padding: 5px;
            cursor: pointer;
            text-align: center;
            text-transform: uppercase;
            transition: all 0.2s;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .btn:hover {
            background: rgba(0, 255, 204, 0.2);
        }

        .btn.active {
            background: var(--accent);
            color: #000;
        }

        #custom-search {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }

        #custom-search input {
            flex: 1;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid var(--border);
            color: var(--accent);
            font-size: 9px;
            padding: 6px;
            outline: none;
        }

        #custom-search button {
            background: var(--accent);
            color: #000;
            border: none;
            padding: 0 10px;
            font-size: 9px;
            font-weight: 900;
            cursor: pointer;
        }

        #sys-log {
            font-size: 8px;
            color: var(--accent);
            opacity: 0.6;
            height: 50px;
            margin-top: 10px;
            overflow: hidden;
            display: flex;
            flex-direction: column-reverse;
            border-top: 1px solid var(--border);
            padding-top: 8px;
        }

        /* RIGHT BLOCK: ANALYTICS */
        #analysis-panel {
            flex: 1;
            pointer-events: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .metric-row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }

        .metric-card {
            background: var(--glass);
            border: 1px solid var(--border);
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .metric-card label {
            font-size: 9px;
            color: var(--accent);
            margin-bottom: 5px;
            letter-spacing: 1px;
        }

        .metric-card .value {
            font-size: 24px;
            font-weight: 900;
            color: #fff;
        }

        .metric-card .unit {
            font-size: 10px;
            opacity: 0.5;
            margin-left: 5px;
        }

        #report-box {
            background: var(--glass);
            border: 1px solid var(--border);
            padding: 25px;
            flex: 1;
            font-size: 12px;
            line-height: 1.8;
            color: #a0ffea;
            position: relative;
            white-space: pre-wrap;
        }

        #report-box::before {
            content: "DEEP_ANALYST_RECON";
            position: absolute;
            top: -8px;
            left: 15px;
            background: #000;
            color: var(--accent);
            font-size: 8px;
            padding: 0 6px;
        }

        .big-title {
            font-size: 50px;
            letter-spacing: 20px;
            color: var(--accent);
            opacity: 0.15;
            text-align: right;
            text-transform: uppercase;
            font-weight: 900;
            margin-top: auto;
        }

        /* MOBILE FIX */
        @media (max-width: 1100px) {
            body {
                overflow-y: auto;
            }

            #ui-dock {
                flex-direction: column;
                transform: scale(1);
                padding: 10px;
                gap: 20px;
            }

            #ui-wrapper {
                height: auto;
                padding: 20px;
                align-items: flex-start;
            }

            #scanner-panel,
            #analysis-panel {
                width: 100%;
                max-width: none;
            }

            .metric-row {
                grid-template-columns: 1fr 1fr;
            }

            .big-title {
                font-size: 24px;
                text-align: center;
                margin-top: 20px;
            }

            #sys-log {
                height: 100px;
            }
        }
    </style>
</head>

<body>
    <canvas id="bg-canvas"></canvas>

    <div id="ui-wrapper">
        <div id="ui-dock">
            <!-- PANEL 1 -->
            <div id="scanner-panel">
                <div class="header">
                    <span>IBONARIUM.ANOMALY.pro_</span>
                    <span id="clock">00:00:00</span>
                </div>

                <div id="anomaly-status">
                    <div class="status-tag">SYSTEM_ACTIVE: SYNC_60S</div>
                </div>

                <div class="viz-box">
                    <canvas id="scan-viz"></canvas>
                </div>

                <div class="data-grid">
                    <div class="data-item">
                        <label>СЕЙСМІКА (MAG)</label>
                        <span id="seismic-val">0.0</span>
                    </div>
                    <div class="data-item">
                        <label>MAG_FIELD (nT)</label>
                        <span id="mag-val">32000</span>
                    </div>
                    <div class="data-item">
                        <label>SOLAR_FLARE</label>
                        <span id="solar-val">G0</span>
                    </div>
                    <div class="data-item">
                        <label>ATM_PRESSURE</label>
                        <span id="press-val">1013</span>
                    </div>
                </div>

                <div id="custom-search">
                    <input type="text" id="s-lat" placeholder="Широта (LAT)">
                    <input type="text" id="s-lon" placeholder="Довгота (LON)">
                    <button id="s-btn">SCAN</button>
                </div>

                <div class="loc-grid" id="loc-grid"></div>

                <div id="sys-log"></div>
            </div>

            <!-- PANEL 2 -->
            <div id="analysis-panel">
                <div class="metric-row">
                    <div class="metric-card">
                        <label>SEISMIC POWER</label>
                        <div class="value" id="m1">0.0<span class="unit">MAG</span></div>
                    </div>
                    <div class="metric-card">
                        <label>GEO_STORM</label>
                        <div class="value" id="m2">Kp 1<span class="unit">QUIET</span></div>
                    </div>
                    <div class="metric-card">
                        <label>COSMIC RADIATION</label>
                        <div class="value" id="m3">0.12<span class="unit">μSv/h</span></div>
                    </div>
                    <div class="metric-card">
                        <label>GRAVITY_VAR</label>
                        <div class="value" id="m4">0.001<span class="unit">mGal</span></div>
                    </div>
                </div>

                <div id="report-box">
                    [ PLANETARY_RECON_INITIALIZED ]
                    Searching for anomalies in planetary magnetic and seismic grids...
                </div>

                <div class="big-title" id="loc-display">GLOBAL_NET</div>
            </div>
        </div>
    </div>

    <script>
        const CITIES = [
            { name: "Київ", lat: 50.45, lon: 30.52 }, { name: "Відень", lat: 48.21, lon: 16.37 },
            { name: "Львів", lat: 49.84, lon: 24.03 }, { name: "Одеса", lat: 46.48, lon: 30.73 },
            { name: "Харків", lat: 50.00, lon: 36.23 }, { name: "Токіо", lat: 35.68, lon: 139.69 },
            { name: "Лос-Анджелес", lat: 34.05, lon: -118.24 }, { name: "Рейк'явік", lat: 64.14, lon: -21.94 },
            { name: "Мехіко", lat: 19.43, lon: -99.13 }, { name: "Стамбул", lat: 41.01, lon: 28.97 },
            { name: "Лондон", lat: 51.51, lon: -0.13 }, { name: "Сідней", lat: -33.86, lon: 151.20 },
            { name: "Нью-Йорк", lat: 40.71, lon: -74.01 }, { name: "Сингапур", lat: 1.35, lon: 103.82 },
            { name: "Дубай", lat: 25.20, lon: 55.27 }, { name: "Берлін", lat: 52.52, lon: 13.40 },
            { name: "Париж", lat: 48.86, lon: 2.35 }, { name: "Пекін", lat: 39.90, lon: 116.40 },
            { name: "Сеул", lat: 37.56, lon: 126.97 }, { name: "Мумбаї", lat: 19.07, lon: 72.87 },
            { name: "Сан-Паулу", lat: -23.55, lon: -46.63 }, { name: "Каїр", lat: 30.04, lon: 31.23 },
            { name: "Сан-Франциско", lat: 37.77, lon: -122.41 }, { name: "Катманду", lat: 27.71, lon: 85.32 }
        ];

        let selected = CITIES[0];
        let globalEarthquakes = [];
        let solarScales = null;

        const locGrid = document.getElementById('loc-grid');
        const bgCanvas = document.getElementById('bg-canvas');
        const bgCtx = bgCanvas.getContext('2d');
        const scCanvas = document.getElementById('scan-viz');
        const scCtx = scCanvas.getContext('2d');

        // INIT CITIES
        CITIES.forEach(city => {
            const b = document.createElement('div');
            b.className = 'btn';
            b.textContent = city.name;
            b.onclick = () => selectCity(city, b);
            locGrid.appendChild(b);
        });

        function selectCity(city, b) {
            selected = city;
            document.querySelectorAll('.btn').forEach(x => x.classList.remove('active'));
            if (b) b.classList.add('active');
            refreshAll();
        }

        // TIME
        setInterval(() => {
            document.getElementById('clock').textContent = new Date().toLocaleTimeString('uk-UA');
        }, 1000);

        // DATA FETCHING
        async function refreshAll() {
            log(`SEARCHING_NODE: ${selected.name.toUpperCase()}`);
            try {
                // Fetch Planets
                const [eqRes, solarRes, meteoRes] = await Promise.all([
                    fetch('https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_hour.geojson'),
                    fetch('https://services.swpc.noaa.gov/products/noaa-scales.json'),
                    fetch(`https://api.open-meteo.com/v1/forecast?latitude=${selected.lat}&longitude=${selected.lon}&current=pressure_msl,wind_speed_10m,wind_gusts_10m`)
                ]);

                globalEarthquakes = (await eqRes.json()).features;
                solarScales = await solarRes.json();
                const meteoData = await meteoRes.json();

                processAnomalies(meteoData.current);
            } catch (e) {
                log(`SYNC_ERROR: RECONNECTING...`);
                console.error(e);
            }
        }

        function calculateDistance(lat1, lon1, lat2, lon2) {
            const p = 0.017453292519943295;
            const c = Math.cos;
            const a = 0.5 - c((lat2 - lat1) * p) / 2 + c(lat1 * p) * c(lat2 * p) * (1 - c((lon2 - lon1) * p)) / 2;
            return 12742 * Math.asin(Math.sqrt(a));
        }

        function processAnomalies(meteo) {
            let nearEQ = { mag: 0, dist: 999999 };
            globalEarthquakes.forEach(f => {
                const d = calculateDistance(selected.lat, selected.lon, f.geometry.coordinates[1], f.geometry.coordinates[0]);
                if (d < nearEQ.dist) { nearEQ = { mag: f.properties.mag, dist: d }; }
            });

            const G = parseInt(solarScales?.['G']?.State || 0);
            const S = parseInt(solarScales?.['S']?.State || 0);
            const R = parseInt(solarScales?.['R']?.State || 0);

            // RADIATION DYNAMIC FORMULA
            const radLevel = (0.12 + (S * 0.1) + (G * 0.05) + Math.random() * 0.05).toFixed(3);

            // UI
            document.getElementById('seismic-val').textContent = nearEQ.mag ? nearEQ.mag.toFixed(1) : "0.0";
            document.getElementById('press-val').textContent = Math.round(meteo.pressure_msl);
            document.getElementById('solar-val').textContent = `SCALE_G${G}`;
            document.getElementById('mag-val').textContent = (32000 + (G * 150) + Math.random() * 50).toFixed(1);

            document.getElementById('m1').innerHTML = `${nearEQ.mag.toFixed(1)} <span class="unit">MAG</span>`;
            document.getElementById('m2').innerHTML = `Kp ${1 + G} <span class="unit">${G > 2 ? 'STORM' : 'QUIET'}</span>`;
            document.getElementById('m3').innerHTML = `${radLevel} <span class="unit">μSv/h</span>`;
            document.getElementById('m4').innerHTML = (0.001 + Math.random() * 0.002).toFixed(4);

            document.getElementById('loc-display').textContent = selected.name.toUpperCase();

            // ALERTS
            const statusBox = document.getElementById('anomaly-status');
            statusBox.innerHTML = '';
            let hasDanger = false;

            if (nearEQ.mag > 4.5 && nearEQ.dist < 800) {
                addAlert("КРИТИЧНА СЕЙСМІЧНА АНОМАЛІЯ", "danger");
                hasDanger = true;
            } else if (nearEQ.mag > 3.0 && nearEQ.dist < 300) {
                addAlert("ЛОКАЛЬНА СЕЙСМІЧНА АКТИВНІСТЬ", "warning");
                hasDanger = true;
            }

            if (G >= 3) {
                addAlert("ЕКСТРЕМАЛЬНИЙ ГЕОМАГНІТНИЙ ШТОРМ", "danger");
                hasDanger = true;
            } else if (G >= 1) {
                addAlert("ГЕОМАГНІТНЕ ЗБУРЕННЯ ВИЯВЛЕНО", "warning");
                hasDanger = true;
            }

            if (radLevel > 0.4) {
                addAlert("ПІДВИЩЕНИЙ РАДІАЦІЙНИЙ ФОН", "danger");
                hasDanger = true;
            }

            if (meteo.wind_gusts_10m > 60) {
                addAlert("АТМОСФЕРНА АНОМАЛІЯ: ШКВАЛЬНИЙ ВІТЕР", "danger");
                hasDanger = true;
            }

            if (!hasDanger) {
                const d = document.createElement('div');
                d.className = "status-tag";
                d.textContent = "> РЕЖИМ СПОСТЕРЕЖЕННЯ: АНОМАЛІЙ НЕ ВИЯВЛЕНО";
                statusBox.appendChild(d);
            }

            generateFullReport(nearEQ, G, S, R, meteo, radLevel);
        }

        function addAlert(txt, type) {
            const d = document.createElement('div');
            d.className = `status-tag ${type}`;
            d.textContent = `!!! ${txt} !!!`;
            document.getElementById('anomaly-status').appendChild(d);
            log(`ALERT: ${txt}`, type);
        }

        function generateFullReport(eq, G, S, R, meteo, rad) {
            let hasDanger = (eq.mag > 4.5 && eq.dist < 1000) || G >= 2 || rad > 0.4 || meteo.wind_gusts_10m > 60;

            let r = `[ SYSTEM_REPORT_v4.5 · ${selected.name.toUpperCase()} ]\n`;
            r += `Широта: ${selected.lat.toFixed(4)} | Довгота: ${selected.lon.toFixed(4)}\n\n`;

            if (hasDanger) {
                r += `>>> [ ANOMALY_DETECTION_LOG ] <<<\n`;
                if (eq.mag > 4) r += `- SEISMIC: Detected ${eq.mag} MAG event within ${Math.round(eq.dist)}km.\n`;
                if (G >= 2) r += `- GEOMAGNETIC: Solar Storm Level G${G} active.\n`;
                if (rad > 0.4) r += `- RADIATION: Cosmic flux exceeds safety threshold (${rad} μSv/h).\n`;
                if (meteo.wind_gusts_10m > 60) r += `- ATMOSPHERE: Critical wind gusts detected.\n`;
                r += `\n`;
            }

            r += `1. ГЕОФІЗИЧНИЙ МОНІТОРИНГ:\n`;
            r += `- Найближчий епіцентр: ${eq.mag.toFixed(1)} MAG\n`;
            r += `- Дистанція: ${Math.round(eq.dist)} км\n`;
            r += `- Статус сейсміки: ${eq.mag > 4 ? 'УВАГА: АКТИВНІСТЬ' : 'СТАБІЛЬНО'}\n\n`;
            r += `2. КОСМІЧНІ ПАРАМЕТРИ (US NOAA):\n`;
            r += `- Геомагнітна буря: G${G} (Scale 0-5)\n`;
            r += `- Сонячна радіація: S${S}\n`;
            r += `- Космічний фон: ${rad} μSv/h\n\n`;
            r += `3. АТМОСФЕРНІ АНОМАЛІЇ:\n`;
            r += `- Вітер: ${meteo.wind_speed_10m} км/год (Пориви: ${meteo.wind_gusts_10m})\n`;
            r += `- Тиск: ${meteo.pressure_msl} hPa\n\n`;

            r += `[ ВИСНОВОК СИСТЕМИ ]\n`;
            if (hasDanger) {
                r += `!!! УВАГА: ВИЯВЛЕНО ПЛАНЕТАРНУ АНОМАЛІЮ. РЕКОМЕНДОВАНО РЕЖИМ ПІДВИЩЕНОЇ ГОТОВНОСТІ. СИНХРОНІЗАЦІЯ З РЕГІОНАЛЬНИМИ СЛУЖБАМИ ПОРУШЕНА.`;
                document.getElementById('report-box').style.borderColor = 'var(--danger)';
            } else {
                r += `СТАН ПЛАНЕТАРНОЇ СІТКИ В МЕЖАХ НОРМИ. АНОМАЛЬНИХ ВІДХИЛЕНЬ НЕ ЗАФІКСОВАНО.`;
                document.getElementById('report-box').style.borderColor = 'var(--border)';
            }

            document.getElementById('report-box').innerText = r;
        }

        function log(m, type = 'accent') {
            const l = document.getElementById('sys-log');
            const d = document.createElement('div');
            d.style.color = type === 'danger' ? 'var(--danger)' : 'var(--accent)';
            d.textContent = `> ${m}`;
            l.prepend(d);
            if (l.childNodes.length > 5) l.removeChild(l.lastChild);
        }

        document.getElementById('s-btn').onclick = () => {
            const lat = parseFloat(document.getElementById('s-lat').value);
            const lon = parseFloat(document.getElementById('s-lon').value);
            if (!isNaN(lat) && !isNaN(lon)) {
                selectCity({ name: "SCAN_COORD", lat, lon }, null);
            } else { log("ERROR: INVALID_COORD_FORMAT", 'danger'); }
        };

        const dots = Array.from({ length: 60 }, () => ({ x: Math.random() * 2000, y: Math.random() * 2000, v: Math.random() * 0.4 + 0.1, s: Math.random() * 2 }));
        function drawBg() {
            bgCanvas.width = window.innerWidth; bgCanvas.height = window.innerHeight;
            bgCtx.fillStyle = '#000'; bgCtx.fillRect(0, 0, bgCanvas.width, bgCanvas.height);
            dots.forEach(p => {
                p.y -= p.v; if (p.y < 0) p.y = bgCanvas.height;
                bgCtx.fillStyle = `rgba(0, 255, 204, ${0.1 + p.v})`;
                bgCtx.fillRect(p.x % bgCanvas.width, p.y, p.s, p.s);
            });
            requestAnimationFrame(drawBg);
        }

        function drawScan(t) {
            scCanvas.width = scCanvas.parentElement.clientWidth; scCanvas.height = scCanvas.parentElement.clientHeight;
            scCtx.clearRect(0, 0, scCanvas.width, scCanvas.height);
            const cx = scCanvas.width / 2; const cy = scCanvas.height / 2;
            const r = 70;
            scCtx.strokeStyle = 'rgba(0, 255, 204, 0.2)';
            for (let i = 1; i <= 3; i++) {
                scCtx.beginPath(); scCtx.arc(cx, cy, (r / 3) * i, 0, Math.PI * 2); scCtx.stroke();
            }
            const angle = (t * 0.002) % (Math.PI * 2);
            scCtx.beginPath(); scCtx.moveTo(cx, cy); scCtx.lineTo(cx + Math.cos(angle) * r, cy + Math.sin(angle) * r);
            scCtx.strokeStyle = '#00ffcc'; scCtx.stroke();
            const g = scCtx.createRadialGradient(cx, cy, 0, cx, cy, r);
            g.addColorStop(0, 'rgba(0, 255, 204, 0.05)'); g.addColorStop(1, 'transparent');
            scCtx.fillStyle = g; scCtx.fill();
            requestAnimationFrame(drawScan);
        }

        window.onload = () => {
            selectCity(CITIES[0], document.querySelector('.btn'));
            drawBg(); drawScan(0);
            setInterval(refreshAll, 60000);
        };
    </script>
</body>

</html>
